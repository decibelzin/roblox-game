local RegisterCommand = require(game.ReplicatedStorage.Shared["register-command"])
local ChatMessage = require(game.ServerScriptService.Server.framework.modules["chat-message"])
local UserIdModule = require(game.ServerScriptService.Server.framework.modules["user-id"])

RegisterCommand({
    name = "useridstats",
    description = "Mostra estatÃ­sticas e diagnÃ³sticos do sistema de User ID",
    aliases = { "idstats", "uidstats", "useriddebug" },
    permissions = { "owner" }
}, function(player, params, message)
    local showDiagnostics = params[1] == "debug" or params[1] == "diag"
    
    if showDiagnostics then
        -- Executar diagnÃ³sticos completos
        local diagnostics = UserIdModule.runDiagnostics()
        
        if diagnostics.success then
            ChatMessage.sendSuccess(player, diagnostics.message)
        else
            ChatMessage.sendError(player, diagnostics.message)
        end
    else
        -- Mostrar estatÃ­sticas bÃ¡sicas
        local currentCounter = UserIdModule.getCurrentCounter()
        
        if not currentCounter then
            ChatMessage.sendError(player, "âŒ Erro ao obter estatÃ­sticas do sistema de User ID!")
            return
        end
        
        local statsMessage = "ğŸ“Š EstatÃ­sticas do Sistema de User ID:\n"
        statsMessage = statsMessage .. "ğŸ”¢ PrÃ³ximo ID disponÃ­vel: " .. (currentCounter + 1) .. "\n"
        statsMessage = statsMessage .. "ğŸ‘¥ Total de jogadores registrados: " .. currentCounter .. "\n"
        statsMessage = statsMessage .. "ğŸ’¡ Use 'useridstats debug' para diagnÃ³sticos detalhados"
        
        ChatMessage.sendInfo(player, statsMessage)
    end
end) 